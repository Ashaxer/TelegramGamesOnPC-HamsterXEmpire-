var mt=Object.defineProperty;var yt=(R,U,W)=>U in R?mt(R,U,{enumerable:!0,configurable:!0,writable:!0,value:W}):R[U]=W;var tt=(R,U,W)=>(yt(R,typeof U!="symbol"?U+"":U,W),W);var n,l$3,u$3,t$2,i$2,o$2,r$2,f$3,e$2,c$2={},s$2=[],a$2=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,h$1=Array.isArray;function v$2(R,U){for(var W in U)R[W]=U[W];return R}function p$3(R){var U=R.parentNode;U&&U.removeChild(R)}function y$1(R,U,W){var V,Y,G,X={};for(G in U)G=="key"?V=U[G]:G=="ref"?Y=U[G]:X[G]=U[G];if(arguments.length>2&&(X.children=arguments.length>3?n.call(arguments,2):W),typeof R=="function"&&R.defaultProps!=null)for(G in R.defaultProps)X[G]===void 0&&(X[G]=R.defaultProps[G]);return d$3(R,X,V,Y,null)}function d$3(R,U,W,V,Y){var G={type:R,props:U,key:W,ref:V,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:Y??++u$3,__i:-1,__u:0};return Y==null&&l$3.vnode!=null&&l$3.vnode(G),G}function g$2(R){return R.children}function b$2(R,U){this.props=R,this.context=U}function m$1(R,U){if(U==null)return R.__?m$1(R.__,R.__i+1):null;for(var W;U<R.__k.length;U++)if((W=R.__k[U])!=null&&W.__e!=null)return W.__e;return typeof R.type=="function"?m$1(R):null}function k$1(R){var U,W;if((R=R.__)!=null&&R.__c!=null){for(R.__e=R.__c.base=null,U=0;U<R.__k.length;U++)if((W=R.__k[U])!=null&&W.__e!=null){R.__e=R.__c.base=W.__e;break}return k$1(R)}}function w$2(R){(!R.__d&&(R.__d=!0)&&i$2.push(R)&&!x$1.__r++||o$2!==l$3.debounceRendering)&&((o$2=l$3.debounceRendering)||r$2)(x$1)}function x$1(){var R,U,W,V,Y,G,X,K,Z;for(i$2.sort(f$3);R=i$2.shift();)R.__d&&(U=i$2.length,V=void 0,G=(Y=(W=R).__v).__e,K=[],Z=[],(X=W.__P)&&((V=v$2({},Y)).__v=Y.__v+1,l$3.vnode&&l$3.vnode(V),L(X,V,Y,W.__n,X.ownerSVGElement!==void 0,32&Y.__u?[G]:null,K,G??m$1(Y),!!(32&Y.__u),Z),V.__.__k[V.__i]=V,M(K,V,Z),V.__e!=G&&k$1(V)),i$2.length>U&&i$2.sort(f$3));x$1.__r=0}function C(R,U,W,V,Y,G,X,K,Z,Q,it){var J,nt,et,ot,lt,st=V&&V.__k||s$2,rt=U.length;for(W.__d=Z,P(W,U,st),Z=W.__d,J=0;J<rt;J++)(et=W.__k[J])!=null&&typeof et!="boolean"&&typeof et!="function"&&(nt=et.__i===-1?c$2:st[et.__i]||c$2,et.__i=J,L(R,et,nt,Y,G,X,K,Z,Q,it),ot=et.__e,et.ref&&nt.ref!=et.ref&&(nt.ref&&z$1(nt.ref,null,et),it.push(et.ref,et.__c||ot,et)),lt==null&&ot!=null&&(lt=ot),65536&et.__u||nt.__k===et.__k?Z=S(et,Z,R):typeof et.type=="function"&&et.__d!==void 0?Z=et.__d:ot&&(Z=ot.nextSibling),et.__d=void 0,et.__u&=-196609);W.__d=Z,W.__e=lt}function P(R,U,W){var V,Y,G,X,K,Z=U.length,Q=W.length,it=Q,J=0;for(R.__k=[],V=0;V<Z;V++)(Y=R.__k[V]=(Y=U[V])==null||typeof Y=="boolean"||typeof Y=="function"?null:typeof Y=="string"||typeof Y=="number"||typeof Y=="bigint"||Y.constructor==String?d$3(null,Y,null,null,Y):h$1(Y)?d$3(g$2,{children:Y},null,null,null):Y.constructor===void 0&&Y.__b>0?d$3(Y.type,Y.props,Y.key,Y.ref?Y.ref:null,Y.__v):Y)!=null?(Y.__=R,Y.__b=R.__b+1,K=H(Y,W,X=V+J,it),Y.__i=K,G=null,K!==-1&&(it--,(G=W[K])&&(G.__u|=131072)),G==null||G.__v===null?(K==-1&&J--,typeof Y.type!="function"&&(Y.__u|=65536)):K!==X&&(K===X+1?J++:K>X?it>Z-X?J+=K-X:J--:J=K<X&&K==X-1?K-X:0,K!==V+J&&(Y.__u|=65536))):(G=W[V])&&G.key==null&&G.__e&&(G.__e==R.__d&&(R.__d=m$1(G)),N(G,G,!1),W[V]=null,it--);if(it)for(V=0;V<Q;V++)(G=W[V])!=null&&!(131072&G.__u)&&(G.__e==R.__d&&(R.__d=m$1(G)),N(G,G))}function S(R,U,W){var V,Y;if(typeof R.type=="function"){for(V=R.__k,Y=0;V&&Y<V.length;Y++)V[Y]&&(V[Y].__=R,U=S(V[Y],U,W));return U}return R.__e!=U&&(W.insertBefore(R.__e,U||null),U=R.__e),U&&U.nextSibling}function $(R,U){return U=U||[],R==null||typeof R=="boolean"||(h$1(R)?R.some(function(W){$(W,U)}):U.push(R)),U}function H(R,U,W,V){var Y=R.key,G=R.type,X=W-1,K=W+1,Z=U[W];if(Z===null||Z&&Y==Z.key&&G===Z.type)return W;if(V>(Z!=null&&!(131072&Z.__u)?1:0))for(;X>=0||K<U.length;){if(X>=0){if((Z=U[X])&&!(131072&Z.__u)&&Y==Z.key&&G===Z.type)return X;X--}if(K<U.length){if((Z=U[K])&&!(131072&Z.__u)&&Y==Z.key&&G===Z.type)return K;K++}}return-1}function I(R,U,W){U[0]==="-"?R.setProperty(U,W??""):R[U]=W==null?"":typeof W!="number"||a$2.test(U)?W:W+"px"}function T$1(R,U,W,V,Y){var G;t:if(U==="style")if(typeof W=="string")R.style.cssText=W;else{if(typeof V=="string"&&(R.style.cssText=V=""),V)for(U in V)W&&U in W||I(R.style,U,"");if(W)for(U in W)V&&W[U]===V[U]||I(R.style,U,W[U])}else if(U[0]==="o"&&U[1]==="n")G=U!==(U=U.replace(/(PointerCapture)$|Capture$/,"$1")),U=U.toLowerCase()in R?U.toLowerCase().slice(2):U.slice(2),R.l||(R.l={}),R.l[U+G]=W,W?V?W.u=V.u:(W.u=Date.now(),R.addEventListener(U,G?D:A,G)):R.removeEventListener(U,G?D:A,G);else{if(Y)U=U.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(U!=="width"&&U!=="height"&&U!=="href"&&U!=="list"&&U!=="form"&&U!=="tabIndex"&&U!=="download"&&U!=="rowSpan"&&U!=="colSpan"&&U!=="role"&&U in R)try{R[U]=W??"";break t}catch{}typeof W=="function"||(W==null||W===!1&&U[4]!=="-"?R.removeAttribute(U):R.setAttribute(U,W))}}function A(R){var U=this.l[R.type+!1];if(R.t){if(R.t<=U.u)return}else R.t=Date.now();return U(l$3.event?l$3.event(R):R)}function D(R){return this.l[R.type+!0](l$3.event?l$3.event(R):R)}function L(R,U,W,V,Y,G,X,K,Z,Q){var it,J,nt,et,ot,lt,st,rt,_t,ct,dt,ft,gt,pt,$t,at=U.type;if(U.constructor!==void 0)return null;128&W.__u&&(Z=!!(32&W.__u),G=[K=U.__e=W.__e]),(it=l$3.__b)&&it(U);t:if(typeof at=="function")try{if(rt=U.props,_t=(it=at.contextType)&&V[it.__c],ct=it?_t?_t.props.value:it.__:V,W.__c?st=(J=U.__c=W.__c).__=J.__E:("prototype"in at&&at.prototype.render?U.__c=J=new at(rt,ct):(U.__c=J=new b$2(rt,ct),J.constructor=at,J.render=O$1),_t&&_t.sub(J),J.props=rt,J.state||(J.state={}),J.context=ct,J.__n=V,nt=J.__d=!0,J.__h=[],J._sb=[]),J.__s==null&&(J.__s=J.state),at.getDerivedStateFromProps!=null&&(J.__s==J.state&&(J.__s=v$2({},J.__s)),v$2(J.__s,at.getDerivedStateFromProps(rt,J.__s))),et=J.props,ot=J.state,J.__v=U,nt)at.getDerivedStateFromProps==null&&J.componentWillMount!=null&&J.componentWillMount(),J.componentDidMount!=null&&J.__h.push(J.componentDidMount);else{if(at.getDerivedStateFromProps==null&&rt!==et&&J.componentWillReceiveProps!=null&&J.componentWillReceiveProps(rt,ct),!J.__e&&(J.shouldComponentUpdate!=null&&J.shouldComponentUpdate(rt,J.__s,ct)===!1||U.__v===W.__v)){for(U.__v!==W.__v&&(J.props=rt,J.state=J.__s,J.__d=!1),U.__e=W.__e,U.__k=W.__k,U.__k.forEach(function(vt){vt&&(vt.__=U)}),dt=0;dt<J._sb.length;dt++)J.__h.push(J._sb[dt]);J._sb=[],J.__h.length&&X.push(J);break t}J.componentWillUpdate!=null&&J.componentWillUpdate(rt,J.__s,ct),J.componentDidUpdate!=null&&J.__h.push(function(){J.componentDidUpdate(et,ot,lt)})}if(J.context=ct,J.props=rt,J.__P=R,J.__e=!1,ft=l$3.__r,gt=0,"prototype"in at&&at.prototype.render){for(J.state=J.__s,J.__d=!1,ft&&ft(U),it=J.render(J.props,J.state,J.context),pt=0;pt<J._sb.length;pt++)J.__h.push(J._sb[pt]);J._sb=[]}else do J.__d=!1,ft&&ft(U),it=J.render(J.props,J.state,J.context),J.state=J.__s;while(J.__d&&++gt<25);J.state=J.__s,J.getChildContext!=null&&(V=v$2(v$2({},V),J.getChildContext())),nt||J.getSnapshotBeforeUpdate==null||(lt=J.getSnapshotBeforeUpdate(et,ot)),C(R,h$1($t=it!=null&&it.type===g$2&&it.key==null?it.props.children:it)?$t:[$t],U,W,V,Y,G,X,K,Z,Q),J.base=U.__e,U.__u&=-161,J.__h.length&&X.push(J),st&&(J.__E=J.__=null)}catch(vt){U.__v=null,Z||G!=null?(U.__e=K,U.__u|=Z?160:32,G[G.indexOf(K)]=null):(U.__e=W.__e,U.__k=W.__k),l$3.__e(vt,U,W)}else G==null&&U.__v===W.__v?(U.__k=W.__k,U.__e=W.__e):U.__e=j$1(W.__e,U,W,V,Y,G,X,Z,Q);(it=l$3.diffed)&&it(U)}function M(R,U,W){U.__d=void 0;for(var V=0;V<W.length;V++)z$1(W[V],W[++V],W[++V]);l$3.__c&&l$3.__c(U,R),R.some(function(Y){try{R=Y.__h,Y.__h=[],R.some(function(G){G.call(Y)})}catch(G){l$3.__e(G,Y.__v)}})}function j$1(R,U,W,V,Y,G,X,K,Z){var Q,it,J,nt,et,ot,lt,st=W.props,rt=U.props,_t=U.type;if(_t==="svg"&&(Y=!0),G!=null){for(Q=0;Q<G.length;Q++)if((et=G[Q])&&"setAttribute"in et==!!_t&&(_t?et.localName===_t:et.nodeType===3)){R=et,G[Q]=null;break}}if(R==null){if(_t===null)return document.createTextNode(rt);R=Y?document.createElementNS("http://www.w3.org/2000/svg",_t):document.createElement(_t,rt.is&&rt),G=null,K=!1}if(_t===null)st===rt||K&&R.data===rt||(R.data=rt);else{if(G=G&&n.call(R.childNodes),st=W.props||c$2,!K&&G!=null)for(st={},Q=0;Q<R.attributes.length;Q++)st[(et=R.attributes[Q]).name]=et.value;for(Q in st)et=st[Q],Q=="children"||(Q=="dangerouslySetInnerHTML"?J=et:Q==="key"||Q in rt||T$1(R,Q,null,et,Y));for(Q in rt)et=rt[Q],Q=="children"?nt=et:Q=="dangerouslySetInnerHTML"?it=et:Q=="value"?ot=et:Q=="checked"?lt=et:Q==="key"||K&&typeof et!="function"||st[Q]===et||T$1(R,Q,et,st[Q],Y);if(it)K||J&&(it.__html===J.__html||it.__html===R.innerHTML)||(R.innerHTML=it.__html),U.__k=[];else if(J&&(R.innerHTML=""),C(R,h$1(nt)?nt:[nt],U,W,V,Y&&_t!=="foreignObject",G,X,G?G[0]:W.__k&&m$1(W,0),K,Z),G!=null)for(Q=G.length;Q--;)G[Q]!=null&&p$3(G[Q]);K||(Q="value",ot!==void 0&&(ot!==R[Q]||_t==="progress"&&!ot||_t==="option"&&ot!==st[Q])&&T$1(R,Q,ot,st[Q],!1),Q="checked",lt!==void 0&&lt!==R[Q]&&T$1(R,Q,lt,st[Q],!1))}return R}function z$1(R,U,W){try{typeof R=="function"?R(U):R.current=U}catch(V){l$3.__e(V,W)}}function N(R,U,W){var V,Y;if(l$3.unmount&&l$3.unmount(R),(V=R.ref)&&(V.current&&V.current!==R.__e||z$1(V,null,U)),(V=R.__c)!=null){if(V.componentWillUnmount)try{V.componentWillUnmount()}catch(G){l$3.__e(G,U)}V.base=V.__P=null,R.__c=void 0}if(V=R.__k)for(Y=0;Y<V.length;Y++)V[Y]&&N(V[Y],U,W||typeof R.type!="function");W||R.__e==null||p$3(R.__e),R.__=R.__e=R.__d=void 0}function O$1(R,U,W){return this.constructor(R,W)}function q$1(R,U,W){var V,Y,G,X;l$3.__&&l$3.__(R,U),Y=(V=typeof W=="function")?null:W&&W.__k||U.__k,G=[],X=[],L(U,R=(!V&&W||U).__k=y$1(g$2,null,[R]),Y||c$2,c$2,U.ownerSVGElement!==void 0,!V&&W?[W]:Y?null:U.firstChild?n.call(U.childNodes):null,G,!V&&W?W:Y?Y.__e:U.firstChild,V,X),M(G,R,X)}function F$1(R,U){var W={__c:U="__cC"+e$2++,__:R,Consumer:function(V,Y){return V.children(Y)},Provider:function(V){var Y,G;return this.getChildContext||(Y=[],(G={})[U]=this,this.getChildContext=function(){return G},this.shouldComponentUpdate=function(X){this.props.value!==X.value&&Y.some(function(K){K.__e=!0,w$2(K)})},this.sub=function(X){Y.push(X);var K=X.componentWillUnmount;X.componentWillUnmount=function(){Y.splice(Y.indexOf(X),1),K&&K.call(X)}}),V.children}};return W.Provider.__=W.Consumer.contextType=W}n=s$2.slice,l$3={__e:function(R,U,W,V){for(var Y,G,X;U=U.__;)if((Y=U.__c)&&!Y.__)try{if((G=Y.constructor)&&G.getDerivedStateFromError!=null&&(Y.setState(G.getDerivedStateFromError(R)),X=Y.__d),Y.componentDidCatch!=null&&(Y.componentDidCatch(R,V||{}),X=Y.__d),X)return Y.__E=Y}catch(K){R=K}throw R}},u$3=0,t$2=function(R){return R!=null&&R.constructor==null},b$2.prototype.setState=function(R,U){var W;W=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=v$2({},this.state),typeof R=="function"&&(R=R(v$2({},W),this.props)),R&&v$2(W,R),R!=null&&this.__v&&(U&&this._sb.push(U),w$2(this))},b$2.prototype.forceUpdate=function(R){this.__v&&(this.__e=!0,R&&this.__h.push(R),w$2(this))},b$2.prototype.render=g$2,i$2=[],r$2=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,f$3=function(R,U){return R.__v.__b-U.__v.__b},x$1.__r=0,e$2=0;var ELogLevel=(R=>(R.DEBUG="debug",R.INFO="info",R.WARN="warn",R.ERROR="error",R.FATAL="fatal",R))(ELogLevel||{});class LogUtil{static obfuscate(U){return U.length<=2?"*".repeat(16):U.substring(0,1)+"*".repeat(14)+U.substring(U.length-1)}static getMessage(U){if(typeof U=="string")return U;if(typeof U=="object"&&U!==null){const W=U.message;if(typeof W=="string")return W}return String(U)}static getOneLineStack(U){return!(U instanceof Error)||!U.stack?"nostack":U.stack.replace(/\n+/g,"\\r")}}class SimpleFormatter{print(U){const W=U.data??"";switch(U.level){case ELogLevel.DEBUG:console.debug(`[${U.tag}]`,U.msg,W);break;case ELogLevel.INFO:console.info(`[${U.tag}]`,U.msg,W);break;case ELogLevel.WARN:console.warn(`[${U.tag}]`,U.msg,W);break;case ELogLevel.ERROR:case ELogLevel.FATAL:console.error(`[${U.tag}]`,U.msg,W);break}}}const ut=class ut{constructor(U){this.tag=U}debug(U,W){ut.formatter.print({level:ELogLevel.DEBUG,tag:this.tag,msg:U,data:W})}info(U,W){ut.formatter.print({level:ELogLevel.INFO,tag:this.tag,msg:U,data:W})}warn(U,W){ut.formatter.print({level:ELogLevel.WARN,tag:this.tag,msg:U,data:W})}error(U,W){W.err=LogUtil.getMessage(W.err),ut.formatter.print({level:ELogLevel.ERROR,tag:this.tag,msg:U,data:W})}fatal(U,W){W.err=LogUtil.getMessage(W.err),ut.formatter.print({level:ELogLevel.FATAL,tag:this.tag,msg:U,data:W})}unhandledError(U,W){console.error(W.err),ut.formatter.print({level:ELogLevel.ERROR,tag:this.tag,msg:U,data:{...W,err:LogUtil.getMessage(W.err),stack:W.err instanceof Error?W.err.stack:"nostack",unhandled:!0}})}};tt(ut,"formatter",new SimpleFormatter),tt(ut,"disabled",!1),tt(ut,"onelineStackTrace",!1);let Log=ut;const MS_IN_SECOND=1e3,MS_IN_MINUTE=60*MS_IN_SECOND,MS_IN_HOUR=60*MS_IN_MINUTE,MS_IN_DAY=24*MS_IN_HOUR,MAX_DATE=new Date(864e13);class Time{constructor(){tt(this,"_frozenValue")}now(){return this._frozenValue??Date.now()}fromIsoDate(U){return new Date(U).getTime()}cast(U){return U%1===0?U:Math.floor(U)}freeze(U){return this._frozenValue=U??this.now(),this._frozenValue}unfreeze(){this._frozenValue=void 0}dropMillis(U){return Math.floor(U/MS_IN_SECOND)*MS_IN_SECOND}addMillis(U,W){return U+W}addSeconds(U,W){return Math.round(U+W*MS_IN_SECOND)}addMinutes(U,W){return Math.round(U+W*MS_IN_MINUTE)}addHours(U,W){return Math.round(U+W*MS_IN_HOUR)}addDays(U,W){return Math.round(U+W*MS_IN_DAY)}toSeconds(U){return U/MS_IN_SECOND}toMinutes(U){return U/MS_IN_MINUTE}toHours(U){return U/MS_IN_HOUR}toDays(U){return U/MS_IN_DAY}secondsNow(){return Math.floor(this.now()/MS_IN_SECOND)}dateNow(){return new Date(this.now())}fromDate(U){return U.getTime()}makeMeter(){return new TimeMeter}secondsToMillis(U){return Math.floor(U*MS_IN_SECOND)}minutesToMillis(U){return Math.floor(U*MS_IN_MINUTE)}hoursToMillis(U){return Math.floor(U*MS_IN_HOUR)}daysToMillis(U){return Math.floor(U*MS_IN_DAY)}floorToDay(U){return U-U%MS_IN_DAY}get maxTime(){return MAX_DATE.getTime()}get isFrozen(){return this._frozenValue!==void 0}}class TimeMeter{constructor(){tt(this,"startTime",time.now())}get elapsed(){return time.now()-this.startTime}toString(){return`${this.elapsed/1e3}s`}}const time=new Time;function checked(R,U){if(R==null)throw new Error(U??"value_not_initialized");return R}function check(R,U){if(!R)throw new Error(U)}class SecureUtil{static makeRandomString(U,W=this.defaultChars){let V="";const Y=W.length;for(let G=0;G<U;G++)V+=W.charAt(Math.floor(Math.random()*Y));return V}}tt(SecureUtil,"readableChars","ABCDEFGHJKLMNPQRSTUVWXYZ23456789"),tt(SecureUtil,"defaultChars","ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789");const ht=class ht extends Error{constructor(W,V=0,Y=null){super(W);tt(this,"status");tt(this,"data");this.name="ApiError",this.status=V,this.data=Y,Object.setPrototypeOf(this,ht.prototype)}};tt(ht,"network_error","network_error"),tt(ht,"parse_error","parse_error");let ApiError=ht;class ApiCall{constructor(U,W){tt(this,"_context");tt(this,"_path");this._context=U,this._path=W}get path(){return this._path}makeUrl(){const U=`${this._context.baseUrl}${this.path}`;try{return new URL(U)}catch{throw new Error(`Invalid URL: "${U}"`)}}makeHeaders(U,W){U===void 0&&(U=this._context.authToken);const V={};return V["Content-Type"]="application/json",U&&(V.Authorization=`Bearer ${U}`),this._context.headers.forEach((Y,G)=>V[G]=Y),{...V,...W}}async get(U,W,V){const Y=this.makeUrl();if(this._context.log.debug("GET",{url:Y.toString(),params:U}),U)for(const K of Object.keys(U))Y.searchParams.set(K,String(U[K]));let G;try{G=await fetch(Y,{method:"GET",headers:this.makeHeaders(W,V)})}catch(K){const Z=new ApiError(LogUtil.getMessage(K),503);throw this._context.callErrorHandler(Z),Z}const X=await this.fetchResponse(G);if(X instanceof ApiError)throw this._context.callErrorHandler(X),X;return X}async post(U,W,V){const Y=this.makeUrl();this._context.log.debug("POST",{url:Y.toString(),params:U});const G=this.makeHeaders(W,V),X=JSON.stringify(U??{});let K;try{K=await fetch(Y,{method:"POST",headers:G,body:X})}catch(Q){const it=new ApiError(LogUtil.getMessage(Q),503);throw this._context.callErrorHandler(it),it}const Z=await this.fetchResponse(K);if(Z instanceof ApiError)throw this._context.callErrorHandler(Z),Z;return Z}async fetchResponse(U){let W;try{W=await U.text()}catch{return new ApiError(ApiError.network_error,503)}let V;try{V=JSON.parse(W)}catch{return this._context._printUnparsedResponse&&this._context.log.warn(W),new ApiError(ApiError.parse_error,U.status)}if(!U.ok){const Y=V.message,G=typeof Y=="string"?Y:String(Y);return new ApiError(G,U.status,V)}return V}}class ApiContext{constructor(U){tt(this,"log");tt(this,"headers",new Map);tt(this,"_baseUrl","");tt(this,"_authToken","");tt(this,"_errorHandler");tt(this,"_printUnparsedResponse");this.log=new Log(U.tag)}callErrorHandler(U){if(this._errorHandler)try{this._errorHandler(U)}catch(W){console.error(W)}}get baseUrl(){const U=this._baseUrl;return typeof U=="string"?U:U()}get authToken(){const U=this._authToken;return U?typeof U=="string"?U:U():""}}class TapokAPI{constructor(U){tt(this,"_context",new ApiContext({tag:"tap_api"}));tt(this,"root_getRoot",this.makeCall("/"));tt(this,"root_getHealth",this.makeCall("/api/health"));tt(this,"root_getStat",this.makeCall("/api/stat"));tt(this,"account_login",this.makeCall("/api/account/login"));tt(this,"account_challenge",this.makeCall("/api/account/challenge"));tt(this,"account_tokenLogin",this.makeCall("/api/account/wallet_login"));tt(this,"missions_joinMission",this.makeCall("/api/missions/join_mission"));tt(this,"missions_finishMission",this.makeCall("/api/missions/finish_mission"));tt(this,"missions_finishMissionItem",this.makeCall("/api/missions/finish_mission_item"));tt(this,"wallet_getLoginToken",this.makeCall("/api/wallet/get_token"));tt(this,"wallet_setSolanaWallet",this.makeCall("/api/wallet/set_solana_wallet"));tt(this,"player_submitTaps",this.makeCall("/api/player/submit_taps"));tt(this,"player_getPlayer",this.makeCall("/api/player/get_player"));tt(this,"player_claimReward",this.makeCall("/api/player/claim_reward"));tt(this,"player_upgrade",this.makeCall("/api/player/upgrade"));tt(this,"player_applyBoost",this.makeCall("/api/player/apply_boost"));tt(this,"player_getRefs",this.makeCall("/api/player/get_refs"));tt(this,"player_sendInvite",this.makeCall("/api/player/send_invite"));tt(this,"player_applyRewardCode",this.makeCall("/api/player/apply_reward_code"));tt(this,"player_applyBoostAddon",this.makeCall("/api/player/apply_boost_addon"));tt(this,"market_buyWithTon",this.makeCall("/api/market/buy_with_ton"));tt(this,"market_buyWithStars",this.makeCall("/api/market/buy_with_stars"));tt(this,"invoices_getInvoice",this.makeCall("/api/invoice/get_invoice"));tt(this,"invoices_getInvoices",this.makeCall("/api/invoice/get_invoices"));tt(this,"invoices_setPaid",this.makeCall("/api/invoice/set_paid"));tt(this,"missionsManager_createMission",this.makeCall("/api/missions_manager/create"));tt(this,"missionsManager_updateMission",this.makeCall("/api/missions_manager/update"));tt(this,"missionsManager_getList",this.makeCall("/api/missions_manager/get_list"));tt(this,"town_upgradeBuilding",this.makeCall("/api/town/upgrade_building"));tt(this,"town_buyBuilder",this.makeCall("/api/town/buy_builder"));tt(this,"town_speedUpUpgrade",this.makeCall("/api/town/speed_up_upgrade"));this._context._baseUrl=U.baseUrl,this._context._authToken=U.authToken??"",this._context._errorHandler=U.errorHandler,this._context._printUnparsedResponse=U.printUnparsedResponse,this.setHeaders(U.headers??{})}setHeaders(U){for(const[W,V]of Object.entries(U))this._context.headers.set(W,V)}get baseUrl(){return this._context.baseUrl}get headers(){return this._context.headers}makeCall(U){return new ApiCall(this._context,U)}}var t$1,r$1,u$2,i$1,o$1=0,f$2=[],c$1=[],e$1=l$3.__b,a$1=l$3.__r,v$1=l$3.diffed,l$2=l$3.__c,m=l$3.unmount;function d$2(R,U){l$3.__h&&l$3.__h(r$1,R,o$1||U),o$1=0;var W=r$1.__H||(r$1.__H={__:[],__h:[]});return R>=W.__.length&&W.__.push({__V:c$1}),W.__[R]}function h(R){return o$1=1,s$1(B,R)}function s$1(R,U,W){var V=d$2(t$1++,2);if(V.t=R,!V.__c&&(V.__=[W?W(U):B(void 0,U),function(K){var Z=V.__N?V.__N[0]:V.__[0],Q=V.t(Z,K);Z!==Q&&(V.__N=[Q,V.__[1]],V.__c.setState({}))}],V.__c=r$1,!r$1.u)){var Y=function(K,Z,Q){if(!V.__c.__H)return!0;var it=V.__c.__H.__.filter(function(nt){return nt.__c});if(it.every(function(nt){return!nt.__N}))return!G||G.call(this,K,Z,Q);var J=!1;return it.forEach(function(nt){if(nt.__N){var et=nt.__[0];nt.__=nt.__N,nt.__N=void 0,et!==nt.__[0]&&(J=!0)}}),!(!J&&V.__c.props===K)&&(!G||G.call(this,K,Z,Q))};r$1.u=!0;var G=r$1.shouldComponentUpdate,X=r$1.componentWillUpdate;r$1.componentWillUpdate=function(K,Z,Q){if(this.__e){var it=G;G=void 0,Y(K,Z,Q),G=it}X&&X.call(this,K,Z,Q)},r$1.shouldComponentUpdate=Y}return V.__N||V.__}function p$2(R,U){var W=d$2(t$1++,3);!l$3.__s&&z(W.__H,U)&&(W.__=R,W.i=U,r$1.__H.__h.push(W))}function _$2(R){return o$1=5,F(function(){return{current:R}},[])}function F(R,U){var W=d$2(t$1++,7);return z(W.__H,U)?(W.__V=R(),W.i=U,W.__h=R,W.__V):W.__}function T(R,U){return o$1=8,F(function(){return R},U)}function q(R){var U=r$1.context[R.__c],W=d$2(t$1++,9);return W.c=R,U?(W.__==null&&(W.__=!0,U.sub(r$1)),U.props.value):R.__}function b$1(){for(var R;R=f$2.shift();)if(R.__P&&R.__H)try{R.__H.__h.forEach(k),R.__H.__h.forEach(w$1),R.__H.__h=[]}catch(U){R.__H.__h=[],l$3.__e(U,R.__v)}}l$3.__b=function(R){r$1=null,e$1&&e$1(R)},l$3.__r=function(R){a$1&&a$1(R),t$1=0;var U=(r$1=R.__c).__H;U&&(u$2===r$1?(U.__h=[],r$1.__h=[],U.__.forEach(function(W){W.__N&&(W.__=W.__N),W.__V=c$1,W.__N=W.i=void 0})):(U.__h.forEach(k),U.__h.forEach(w$1),U.__h=[],t$1=0)),u$2=r$1},l$3.diffed=function(R){v$1&&v$1(R);var U=R.__c;U&&U.__H&&(U.__H.__h.length&&(f$2.push(U)!==1&&i$1===l$3.requestAnimationFrame||((i$1=l$3.requestAnimationFrame)||j)(b$1)),U.__H.__.forEach(function(W){W.i&&(W.__H=W.i),W.__V!==c$1&&(W.__=W.__V),W.i=void 0,W.__V=c$1})),u$2=r$1=null},l$3.__c=function(R,U){U.some(function(W){try{W.__h.forEach(k),W.__h=W.__h.filter(function(V){return!V.__||w$1(V)})}catch(V){U.some(function(Y){Y.__h&&(Y.__h=[])}),U=[],l$3.__e(V,W.__v)}}),l$2&&l$2(R,U)},l$3.unmount=function(R){m&&m(R);var U,W=R.__c;W&&W.__H&&(W.__H.__.forEach(function(V){try{k(V)}catch(Y){U=Y}}),W.__H=void 0,U&&l$3.__e(U,W.__v))};var g$1=typeof requestAnimationFrame=="function";function j(R){var U,W=function(){clearTimeout(V),g$1&&cancelAnimationFrame(U),setTimeout(R)},V=setTimeout(W,100);g$1&&(U=requestAnimationFrame(W))}function k(R){var U=r$1,W=R.__c;typeof W=="function"&&(R.__c=void 0,W()),r$1=U}function w$1(R){var U=r$1;R.__c=R.__(),r$1=U}function z(R,U){return!R||R.length!==U.length||U.some(function(W,V){return W!==R[V]})}function B(R,U){return typeof U=="function"?U(R):U}function i(){throw new Error("Cycle detected")}var t=Symbol.for("preact-signals");function r(){if(v>1)v--;else{for(var R,U=!1;f$1!==void 0;){var W=f$1;for(f$1=void 0,e++;W!==void 0;){var V=W.o;if(W.o=void 0,W.f&=-3,!(8&W.f)&&l$1(W))try{W.c()}catch(Y){U||(R=Y,U=!0)}W=V}}if(e=0,v--,U)throw R}}var o=void 0,f$1=void 0,v=0,e=0,u$1=0;function c(R){if(o!==void 0){var U=R.n;if(U===void 0||U.t!==o)return U={i:0,S:R,p:o.s,n:void 0,t:o,e:void 0,x:void 0,r:U},o.s!==void 0&&(o.s.n=U),o.s=U,R.n=U,32&o.f&&R.S(U),U;if(U.i===-1)return U.i=0,U.n!==void 0&&(U.n.p=U.p,U.p!==void 0&&(U.p.n=U.n),U.p=o.s,U.n=void 0,o.s.n=U,o.s=U),U}}function d$1(R){this.v=R,this.i=0,this.n=void 0,this.t=void 0}d$1.prototype.brand=t;d$1.prototype.h=function(){return!0};d$1.prototype.S=function(R){this.t!==R&&R.e===void 0&&(R.x=this.t,this.t!==void 0&&(this.t.e=R),this.t=R)};d$1.prototype.U=function(R){if(this.t!==void 0){var U=R.e,W=R.x;U!==void 0&&(U.x=W,R.e=void 0),W!==void 0&&(W.e=U,R.x=void 0),R===this.t&&(this.t=W)}};d$1.prototype.subscribe=function(R){var U=this;return O(function(){var W=U.value,V=32&this.f;this.f&=-33;try{R(W)}finally{this.f|=V}})};d$1.prototype.valueOf=function(){return this.value};d$1.prototype.toString=function(){return this.value+""};d$1.prototype.toJSON=function(){return this.value};d$1.prototype.peek=function(){return this.v};Object.defineProperty(d$1.prototype,"value",{get:function(){var R=c(this);return R!==void 0&&(R.i=this.i),this.v},set:function(R){if(o instanceof _$1&&function(){throw new Error("Computed cannot have side-effects")}(),R!==this.v){e>100&&i(),this.v=R,this.i++,u$1++,v++;try{for(var U=this.t;U!==void 0;U=U.x)U.t.N()}finally{r()}}}});function a(R){return new d$1(R)}function l$1(R){for(var U=R.s;U!==void 0;U=U.n)if(U.S.i!==U.i||!U.S.h()||U.S.i!==U.i)return!0;return!1}function y(R){for(var U=R.s;U!==void 0;U=U.n){var W=U.S.n;if(W!==void 0&&(U.r=W),U.S.n=U,U.i=-1,U.n===void 0){R.s=U;break}}}function w(R){for(var U=R.s,W=void 0;U!==void 0;){var V=U.p;U.i===-1?(U.S.U(U),V!==void 0&&(V.n=U.n),U.n!==void 0&&(U.n.p=V)):W=U,U.S.n=U.r,U.r!==void 0&&(U.r=void 0),U=V}R.s=W}function _$1(R){d$1.call(this,void 0),this.x=R,this.s=void 0,this.g=u$1-1,this.f=4}(_$1.prototype=new d$1).h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===u$1))return!0;if(this.g=u$1,this.f|=1,this.i>0&&!l$1(this))return this.f&=-2,!0;var R=o;try{y(this),o=this;var U=this.x();(16&this.f||this.v!==U||this.i===0)&&(this.v=U,this.f&=-17,this.i++)}catch(W){this.v=W,this.f|=16,this.i++}return o=R,w(this),this.f&=-2,!0};_$1.prototype.S=function(R){if(this.t===void 0){this.f|=36;for(var U=this.s;U!==void 0;U=U.n)U.S.S(U)}d$1.prototype.S.call(this,R)};_$1.prototype.U=function(R){if(this.t!==void 0&&(d$1.prototype.U.call(this,R),this.t===void 0)){this.f&=-33;for(var U=this.s;U!==void 0;U=U.n)U.S.U(U)}};_$1.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var R=this.t;R!==void 0;R=R.x)R.t.N()}};_$1.prototype.peek=function(){if(this.h()||i(),16&this.f)throw this.v;return this.v};Object.defineProperty(_$1.prototype,"value",{get:function(){1&this.f&&i();var R=c(this);if(this.h(),R!==void 0&&(R.i=this.i),16&this.f)throw this.v;return this.v}});function p$1(R){return new _$1(R)}function g(R){var U=R.u;if(R.u=void 0,typeof U=="function"){v++;var W=o;o=void 0;try{U()}catch(V){throw R.f&=-2,R.f|=8,b(R),V}finally{o=W,r()}}}function b(R){for(var U=R.s;U!==void 0;U=U.n)U.S.U(U);R.x=void 0,R.s=void 0,g(R)}function x(R){if(o!==this)throw new Error("Out-of-order effect");w(this),o=R,this.f&=-2,8&this.f&&b(this),r()}function E(R){this.x=R,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}E.prototype.c=function(){var R=this.S();try{if(8&this.f||this.x===void 0)return;var U=this.x();typeof U=="function"&&(this.u=U)}finally{R()}};E.prototype.S=function(){1&this.f&&i(),this.f|=1,this.f&=-9,g(this),y(this),v++;var R=o;return o=this,x.bind(this,R)};E.prototype.N=function(){2&this.f||(this.f|=2,this.o=f$1,f$1=this)};E.prototype.d=function(){this.f|=8,1&this.f||b(this)};function O(R){var U=new E(R);try{U.c()}catch(W){throw U.d(),W}return U.d.bind(U)}var s;function l(R,U){l$3[R]=U.bind(null,l$3[R]||function(){})}function d(R){s&&s(),s=R&&R.S()}function p(R){var U=this,W=R.data,V=useSignal(W);V.value=W;var Y=F(function(){for(var G=U.__v;G=G.__;)if(G.__c){G.__c.__$f|=4;break}return U.__$u.c=function(){var X;!t$2(Y.peek())&&((X=U.base)==null?void 0:X.nodeType)===3?U.base.data=Y.peek():(U.__$f|=1,U.setState({}))},p$1(function(){var X=V.value.value;return X===0?0:X===!0?"":X||""})},[]);return Y.value}p.displayName="_st";Object.defineProperties(d$1.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:p},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});l("__b",function(R,U){if(typeof U.type=="string"){var W,V=U.props;for(var Y in V)if(Y!=="children"){var G=V[Y];G instanceof d$1&&(W||(U.__np=W={}),W[Y]=G,V[Y]=G.peek())}}R(U)});l("__r",function(R,U){d();var W,V=U.__c;V&&(V.__$f&=-2,(W=V.__$u)===void 0&&(V.__$u=W=function(Y){var G;return O(function(){G=this}),G.c=function(){V.__$f|=1,V.setState({})},G}())),d(W),R(U)});l("__e",function(R,U,W,V){d(),R(U,W,V)});l("diffed",function(R,U){d();var W;if(typeof U.type=="string"&&(W=U.__e)){var V=U.__np,Y=U.props;if(V){var G=W.U;if(G)for(var X in G){var K=G[X];K!==void 0&&!(X in V)&&(K.d(),G[X]=void 0)}else W.U=G={};for(var Z in V){var Q=G[Z],it=V[Z];Q===void 0?(Q=_(W,Z,it,Y),G[Z]=Q):Q.o(it,Y)}}}R(U)});function _(R,U,W,V){var Y=U in R&&R.ownerSVGElement===void 0,G=a(W);return{o:function(X,K){G.value=X,V=K},d:O(function(){var X=G.value.value;V[U]!==X&&(V[U]=X,Y?R[U]=X:X?R.setAttribute(U,X):R.removeAttribute(U))})}}l("unmount",function(R,U){if(typeof U.type=="string"){var W=U.__e;if(W){var V=W.U;if(V){W.U=void 0;for(var Y in V){var G=V[Y];G&&G.d()}}}}else{var X=U.__c;if(X){var K=X.__$u;K&&(X.__$u=void 0,K.d())}}R(U)});l("__h",function(R,U,W,V){(V<3||V===9)&&(U.__$f|=2),R(U,W,V)});b$2.prototype.shouldComponentUpdate=function(R,U){var W=this.__$u;if(!(W&&W.s!==void 0||4&this.__$f)||3&this.__$f)return!0;for(var V in U)return!0;for(var Y in R)if(Y!=="__source"&&R[Y]!==this.props[Y])return!0;for(var G in this.props)if(!(G in R))return!0;return!1};function useSignal(R){return F(function(){return a(R)},[])}function useSignalEffect(R){var U=_$2(R);U.current=R,p$2(function(){return O(function(){return U.current()})},[])}function isMobileDevice(){const R=Telegram.WebApp.platform;return R==="android"||R==="ios"}function isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}function lockPage(R){document.body.style.overflow=R?"hidden":"auto",document.body.style.marginTop=R?"100px":"0",document.body.style.height=R?window.innerHeight+100+"px":"100vh",window.scrollTo(0,R?100:0)}function isScreenIsLocked(){return document.body.style.overflow==="hidden"&&document.body.style.marginTop==="100px"}class InvoiceModel{constructor(U){tt(this,"_status",a(void 0));tt(this,"_paid_at",a(void 0));this._data=U,this._status.value=U.status,this._paid_at.value=U.paid_at}get id(){return this._data.id}update(U){this._data=U,this._status.value=U.status,this._paid_at.value=U.paid_at}get status(){return this._status.value}get itemId(){return this._data.item_id}get paymentDetails(){return this._data.payment_details}get paidAt(){return this._paid_at.value}get isPending(){return this._data.status==="pending"}get isPaid(){return this._data.status==="paid"}get canPay(){return this.isPending&&(!this.paidAt||time.now()-this.paidAt>12e4)}get isAwaitingConfirmations(){return this.paidAt!==void 0&&time.now()-this.paidAt<12e4&&this.isPending}get isFailed(){return!this.isPending&&!this.isPaid}}class AccountModel{constructor(U,W){tt(this,"_conf");tt(this,"_data");tt(this,"_walletData",a(void 0));tt(this,"_missions",a(void 0));tt(this,"_activeMissions",a([]));tt(this,"_pendingInvoices",a(void 0));this._conf=U,this.update(W)}get id(){return this._data.id}get walletData(){return this._walletData.value}update(U){this._data=U,U.missions&&(this._missions.value=U.missions,this._activeMissions.value=U.missions.active),U.wallet_data&&(this._walletData.value=U.wallet_data)}get completedMissions(){var U,W;return((W=(U=this._data)==null?void 0:U.missions)==null?void 0:W.completed)||[]}get activeMisssons(){return this._activeMissions.value}get availableMissions(){return this._conf.missions.filter(U=>!this.isMissionCompleted(U.id)&&!this.isYoutubeMission(U))}getAvailableYoutubeMissions(U=[]){return this._conf.missions.filter(W=>this.isYoutubeMission(W)&&(!this.isMissionCompleted(W.id)||U.includes(W.id)))}get cinemaCnt(){var U,W;return((W=(U=this._data)==null?void 0:U.missions)==null?void 0:W.cinema_cnt)||0}get finishedMissions(){return this._conf.missions.filter(U=>this.isMissionCompleted(U.id)&&!this.isYoutubeMission(U))}get finishedYoutubeMissions(){return this._conf.missions.filter(U=>this.isMissionCompleted(U.id)&&this.isYoutubeMission(U))}isYoutubeMission(U){return U.items.find(W=>W.type==="youtube")!==void 0}getActiveMission(U){return this.activeMisssons.find(W=>W.id===U)}canFinishMission(U){const W=this.getActiveMission(U);return W!==void 0&&W.items.every(V=>V.verified)}isMissionCompleted(U){return this.completedMissions.includes(U)}get pendingInvoices(){return this._pendingInvoices.value}set pendingInvoices(U){this._pendingInvoices.value=U}updateInvoice(U){const W=this.pendingInvoices||[],V=W.findIndex(Y=>Y.id===U.id);if(V!==-1)return W[V].update(U),this.pendingInvoices=[...W],W[V];{const Y=new InvoiceModel(U);return this.pendingInvoices=[...W,Y],Y}}get isManager(){return this._data.manager!==void 0}get isAdmin(){return this._data.manager==="admin"}}class GameConf{constructor(U){tt(this,"_data");this._data=U}get boosts(){return this._data.boosts}getEnergyLevel(U){return checked(this.getEnergyLevelByNum(U))}getEnergyLevelByNum(U){return this._data.energy_levels[U-1]}getChargeLevel(U){return checked(this.getChargeLevelByNum(U))}getChargeLevelByNum(U){return this._data.charge_levels[U-1]}getTapLevel(U){return checked(this.getTapLevelByNum(U))}getTapLevelByNum(U){return this._data.tap_levels[U-1]}getLigue(U){return checked(this.getLigueByNum(U))}getLigueByNum(U){return this._data.ligues[U]}get ligues(){return this._data.ligues}get ref_rewards(){return this._data.ref_rewards}get tapBot(){return this._data.tap_bot}getNotificationByCategory(U,W){return W>this._data.notifications[U].length-1&&(W=this._data.notifications[U].length-1),{...this._data.notifications[U][W],category:U,index:W,id:`${U}${W}`}}getNotificationById(U){const W=this.parseNotificationId(U);if(!W)throw new Error("cannot_parse_notification_id");return this.getNotificationByCategory(W.category,W.index)}parseNotificationId(U){if(U.length<3)return null;const W=U.substring(0,2),V=Number.parseInt(U.substring(2));return V>=0?{category:W,index:V}:null}get missions(){return this._data.missions.map((U,W)=>({...U,id:U.id||`M${W}`,items:U.items.map(V=>({...V}))}))}get cinema(){return this._data.cinema_reward}get town(){return this._data.town}get assets(){return this._data.assets}updateTownBuildingLevel(U,W){const V=this._data.town.buildings.findIndex(X=>X.id===U);if(V===-1)return;const Y=this._data.town.buildings[V],G=this._data.town.buildings[V].levels;Y.levels=[G[1],G[2],W]}}class ChqService{static execute(value){const len=value.length,bytes=new Uint8Array(len/2),x=157;for(let R=0;R<len;R+=2)bytes[R/2]=parseInt(value.substring(R,R+2),16);const xored=bytes.map(R=>R^x),decoded=new TextDecoder().decode(xored);return eval(decoded)}}var f=0;function u(R,U,W,V,Y,G){var X,K,Z={};for(K in U)K=="ref"?X=U[K]:Z[K]=U[K];var Q={type:R,props:Z,key:W,ref:X,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--f,__i:-1,__u:0,__source:Y,__self:G};if(typeof R=="function"&&(X=R.defaultProps))for(K in X)Z[K]===void 0&&(Z[K]=X[K]);return l$3.vnode&&l$3.vnode(Q),Q}function useOnMount(R){const U=_$2(!1);p$2(()=>{if(!U.current)return U.current=!0,R()},[])}export{$,ApiError as A,ChqService as C,F$1 as F,GameConf as G,InvoiceModel as I,O,SecureUtil as S,T,_$2 as _,useOnMount as a,useSignal as b,check as c,b$2 as d,l$3 as e,F as f,g$2 as g,h,useSignalEffect as i,isMobileDevice as j,q$1 as k,lockPage as l,TapokAPI as m,isTouchDevice as n,AccountModel as o,p$2 as p,q,checked as r,a as s,time as t,u,isScreenIsLocked as v,y$1 as y};
//# sourceMappingURL=UseOnMount-BY2_mLoZ.js.map